{{>layout/header}}
<div id="register-div" style="margin: 10px">
<script src="https://uicdn.toast.com/editor/2.0.0/toastui-editor-all.min.js"></script>
<script type="text/javascript" src="/js/problem.js"></script>

<script>
    let div = document.getElementById("register-div")

    if (sessionStorage.getItem("access_token")) {
        $.ajax({
            type: "GET",
            url: "/api/members/check",
            headers: {"Authorization": sessionStorage.getItem("access_token"), "Content-type": "application/json"},
            contentType: "application/json; charset=utf-8",
            dataType: "json"
        }).done(function (result) {
            const status = result.status;
            if (status === 200) {
                div.innerHTML+= `
                <div style="margin: 10px">
                    <textarea placeholder="제목을 입력하세요" id="title" style="height: 66px;"></textarea>
                    <div class="bold-line-left"></div>
                    <div class="sc-jeCdPy jOSCEK">
                        <input placeholder="태그를 입력하세요" id="tag" tabindex="2" value="" class="sc-jtRlXQ cspOdp">
                        <div id="tag-block"></div>` ;


                    $(document).ready(function () {
                        $("#tag").keydown(function (key) {
                            if (key.keyCode == 13) { // 엔터키 이벤트
                                key.preventDefault();
                                let tagName = $("#tag").val();
                                let tagBlock = document.getElementById("tag-block");
                                tagBlock.innerHTML += ' <button class="btn-tag" value=' + tagName + '>' + tagName + "</button> "
                                $("#tag").val("");
                            }
                        });
                    });

                    div.innerHTML += `
                    </div>
                    <div class="light-line-left"></div>
                    <textarea placeholder="문제 링크를 입력하세요" id="link"></textarea>
                    <div class="light-line-left"></div>
                    <div>
                        <input hidden id="step" value="1">
                        <b>난이도</b>&nbsp
                        <img class="star" width="35" id="star1" src="/image/star_selected.png" onclick="selectStar(1)"><img class="star"
                                                                                                                            width="35"
                                                                                                                            id="star2"
                                                                                                                            src="/image/star_not_selected.png"
                                                                                                                            onclick="selectStar(2)"><img
                            class="star" width="35" id="star3" src="/image/star_not_selected.png" onclick="selectStar(3)"><img
                            class="star" width="35" id="star4" src="/image/star_not_selected.png" onclick="selectStar(4)"><img
                            class="star" width="35" id="star5" src="/image/star_not_selected.png" onclick="selectStar(5)">
                        <select id="notificationDate" class="form-control select-box">
                            <option value="1" selected>알림 기한 설정</option>
                            <option value="5">일주일 후 알림</option>
                            <option value="4">이주일 후 알림</option>
                            <option value="3">한 달 후 알림</option>
                            <option value="2">두 달 후 알림</option>
                            <option value="1">세 달 후 알림</option>
                        </select>
                    </div>
                    <div id="editor" style="box-sizing: border-box; margin-top: 10px; height: 700px;"></div>
                    <br/>
                    <button id="btn-register" style="float: right;" class="btn btn-dark">등록하기</button>
                    <br/>
                </div>
               `;
                /* eslint-disable no-unused-vars */
                const content = [].join('\n');

                const editor = new toastui.Editor({
                    el: document.querySelector('#editor'),
                    previewStyle: 'vertical',
                    initialEditType: "markdown",
                    height: '500px',
                    initialValue: content
                });


                $("#btn-register").on("click", () => {
                    index.register();
                });

            } else {
                alert("등록 권한이 없습니다. 문아영한테 문의하시길.");
            }
        })
    } else {
        location.href = "/user/login"
    }


    function selectStar(starNum) {
        console.log(starNum)
        document.getElementById("step").value = starNum
        let num
        for (num = 1; num <= starNum; num++)
            document.getElementById("star" + num).src = "/image/star_selected.png";
        for (num = starNum + 1; num <= 5; num++)
            document.getElementById("star" + num).src = "/image/star_not_selected.png";
    }
</script>
<script src="https://uicdn.toast.com/editor/2.0.0/toastui-editor-all.min.js"></script>
<script type="text/javascript" src="/js/problem.js"></script>